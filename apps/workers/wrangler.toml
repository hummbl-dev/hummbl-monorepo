name = "hummbl-workers"
main = "src/index.ts"
compatibility_date = "2024-12-02"
compatibility_flags = ["nodejs_compat"]

[observability]
enabled = true

# D1 Database binding for mental models storage
[[d1_databases]]
binding = "DB"
database_name = "hummbl-models"
database_id = "TO_BE_CREATED"  # Run: wrangler d1 create hummbl-models

# KV namespace for caching
[[kv_namespaces]]
binding = "CACHE"
id = "TO_BE_CREATED"  # Run: wrangler kv:namespace create CACHE
preview_id = "a584d2551d4c465aaecbf869d9771d84"

# R2 bucket for static assets/exports
[[r2_buckets]]
binding = "ASSETS"
bucket_name = "hummbl-assets"

# Environment variables
[vars]
ENVIRONMENT = "production"
API_VERSION = "v1"

# Staging environment
[env.staging]
name = "hummbl-workers-staging"
vars = { ENVIRONMENT = "staging" }

[[env.staging.d1_databases]]
binding = "DB"
database_name = "hummbl-models-staging"
database_id = "TO_BE_CREATED"

[[env.staging.kv_namespaces]]
binding = "CACHE"
id = "TO_BE_CREATED"
